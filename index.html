<html>
  <head>
    <title>
      Github Profiles
    </title>
    <link href="./styles/report.css" rel="stylesheet">
  </head>
  <body>

    <form id='add_profile'>
    <input id='username' placeholder="Enter a Github username">
    <button class="load-profile" type="submit">Load profile</button>
    </form>

    <section class="error-container">

    </section>

    <section class="profile-container">

    </section>

    <template id='profile-template'>
      <section class="profile">
        <a href="#" class="close">x</a>
        <section class="avatar">
          <img src="{{ avatar_url}}">
        </section>

        <section class="details">
          <h3>
            <a href="{{ html_url}}">
              {{ login }}
            </a>
          </h3>
          <h4>
            Repos: {{public_repos}}
          </h4>
          <h4>
            Followers: {{followers}}
          </h4>
        </section>
        <br clear="all">
      </section>
    </template>

    <template id="error-template">
      <section class="error-message">
        <p>{{ error }}</p>
        <p>click to dismiss</p>
      </section>
    </template>


    <script src='https://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.8.1/mustache.js'></script>
    <script src='https://code.jquery.com/jquery-2.1.1.min.js'></script>
    <script src='key.js'></script>
    <script>
      function addProfile(username) {
        $.get('http://api.github.com/users/'+ username + '?' + 'client_id=' + client_id + '&client_secret=' + client_secret, function(user){
          var newProfile = Mustache.render($('#profile-template').html(), user);
          $(newProfile).appendTo('.profile-container').slideDown();
        }).error(function(){
          var errorMessage = "Sorry, there's no user with the username: " + username
          var message = Mustache.render($('#error-template').html(),{error: errorMessage})
          $(message).appendTo('.error-container').slideDown("slow", function(){
          });
        }).always(function(){
          $('#username').val('');
        })
      };

      $(document).ready(function(){
        $(".load-profile").on('click',function(event){
          event.preventDefault();
          addProfile($('#username').val());
          });
        $('.profile-container').on('click', '.close', function(){
          $(this).closest('.profile').slideUp(function(){
            $(this).remove();
          });
        });
        $('.error-container').on('click', '.error-message', function(){
          $(this).slideUp(1000, function() {
            $(this).remove();
          });
        });
      });
    </script>


  </body>
</html>
